workdir: "/rds/project/rs2099/rds-rs2099-toxgenomics/sita/{config['dir']}"

rule all:
    input:
        "processed/MAplot.png",
        "processed/DEstats.txt"

rule quasr_map_count:
    input:
        sample_file = "SampleFile.txt"
        metadata = "SraRunTable.txt"
    output:
        exon = "processed/ExonicCounts.txt",
        intron = "processed/IntronicCounts.txt"
    script:
        "/home/xwy21/project/sita/script/generate_samplefile.py -m {input.metadata} -e fastq"
        "/home/xwy21/project/sita/script/02_alignment_and_counting.R -i {input.sample_file} -m {input.metadata}"

rule run_eisa:
    input:
        exon = "processed/ExonicCounts.txt",
        intron = "processed/IntronicCounts.txt"
    output:
        "processed/MAplot.png",
        "processed/DEstats.txt"
    script:
        "/home/xwy21/project/sita/script/03_eisa.R -i {input.intron} -e {input.exon}"

